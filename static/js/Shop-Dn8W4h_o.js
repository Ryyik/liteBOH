import{r as e,b as a,d as l,z as s,w as t,c as o,h as i,f as r,g as c,p as n,v as u,F as d,k as v,i as p,j as g,m,q as h,t as b,n as w,x as y,o as C}from"./vue-vendor-4rUpFloF.js";import{_ as f,U as k,F as x,g as L}from"./ui-components-YpADZkt5.js";const G={class:"shop-page"},M={class:"shop-nav"},_={class:"search-container"},T={class:"search-wrapper"},B={key:0,class:"search-suggestions"},P=["onClick"],V={class:"suggestion-title"},$={class:"suggestion-category"},A={class:"user-section"},I={class:"category-filter"},U=["onClick"],Z={class:"container"},j={class:"products-grid",id:"productsGrid"},q=["data-id","onClick"],H={class:"product-image"},N=["srcset"],z=["src","alt"],O={class:"product-content"},D={class:"product-category"},E={class:"product-title"},F={class:"product-description"},J={class:"product-price"},R=["onClick"],S={key:0,class:"no-products"},W={class:"boh-form-group"},Y={class:"boh-form-group"},K={class:"boh-password-wrap"},Q=["type"],X={key:0,class:"boh-auth-error"},ee={class:"boh-form-links"},ae=["disabled"],le={class:"modal-body-layout"},se={class:"modal-image-side"},te=["src","alt"],oe={class:"modal-info-side"},ie={class:"modal-category"},re={class:"modal-title"},ce={class:"modal-price"},ne={class:"modal-description"},ue={class:"modal-actions"},de=f({__name:"Shop",setup(f){const de=e=>{if(!e||e.startsWith("data:"))return e;const a=e.replace(/\.(png|jpg|jpeg|PNG|JPG|JPEG)$/i,".webp");return L(a)},ve=e([{id:8,category:"周边",title:"BOH BAG-Air（胸包）",description:"白色背景图+黑色文字，黑色文字为BOH BAG系列",price:"¥39.99",image:"xnbag-1.PNG"},{id:1,category:"周边",title:"方块之家7周年纪念册",description:"硬壳精装版，记录方块之家7年来的点点滴滴。",price:"¥34.99",image:"Commemorative-album.PNG"},{id:2,category:"周边",title:"方块之家明信片套装",description:"8张精美明信片，展示方块之家建筑风光。",price:"¥8.99",image:"2025-7years.png"},{id:3,category:"周边",title:"方块之家7周年海报",description:"高品质印刷，记录7周年美好瞬间。",price:"¥12.99",image:"2024-newyears.png"},{id:4,category:"礼物",title:"小牛定制吧唧",description:"金属吧唧，小牛形象设计。",price:"¥6.99",image:"main3.png"},{id:5,category:"定制",title:"小牛定制流麻",description:"动态流沙麻将，blingbling效果。",price:"待定",image:"main2.webp"},{id:6,category:"礼物",title:"方块之家钥匙扣",description:"精致钥匙扣，多种款式可选。",price:"¥5.99",image:"xnbag-2.PNG"},{id:7,category:"定制",title:"像素乐高形象109",description:"根据您的设计定制专属像素乐高形象。",price:"¥199.99",image:"xnbag-3.PNG"}]),pe=e(""),ge=e(!1),me=e([]);let he=null;const be=e(!1),we=e(!1),ye=e(!1),Ce=e(!1),fe=e({username:"",password:""}),ke=e(!1),xe=e(""),Le=()=>{const{username:e,password:a}=fe.value;Ce.value=!1,!e.trim()||!a.trim()||a.length<6||(ye.value=!0,setTimeout(()=>{window.AuthManager.login(e,a).success?(ke.value=!0,xe.value=e,be.value=!1,fe.value={username:"",password:""}):Ce.value=!0,ye.value=!1},500))},Ge=()=>{alert("由于技术限制，请联系网站开发者解决该问题。")},Me=e([{label:"全部",value:""},{label:"礼物",value:"礼物"},{label:"周边",value:"周边"},{label:"定制",value:"定制"}]),_e=e(""),Te=a(()=>ke.value?{id:xe.value.toLowerCase().replace(/\s+/g,"-")+"-"+Math.floor(1e4*Math.random()),username:xe.value}:{id:"guest-12345",username:"guest"}),Be=e=>{ke.value||(e.preventDefault(),be.value=!0)},Pe=a(()=>ke.value?"/user-center/address":"#"),Ve=e=>{const a=`${Te.value.username}在BOH官网选择了${e.category}${e.title}\n查看链接：${window.location.origin}${window.location.pathname}?productId=${e.id}`;navigator.clipboard.writeText(a).then(()=>{alert("分享内容已复制到剪贴板")}).catch(e=>{alert(a)})},$e=a(()=>{let e=[...ve.value];if(_e.value&&(e=e.filter(e=>e.category===_e.value)),pe.value){const a=pe.value.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(a)||e.description.toLowerCase().includes(a))}return e}),Ae=e=>{const a=e.target.value.toLowerCase();a.length>0?(he&&clearTimeout(he),he=setTimeout(()=>{me.value=ve.value.filter(e=>e.title.toLowerCase().includes(a)||e.description.toLowerCase().includes(a)),ge.value=!0},300)):(ge.value=!1,me.value=[])},Ie=e(null),Ue=()=>{Ie.value=null,document.body.style.overflow=""},Ze=e([]);let je=null;const qe=()=>{je&&je.disconnect(),je=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.target.classList.add("visible")})},{threshold:.1,rootMargin:"0px 0px -50px 0px"}),Ze.value&&Ze.value.forEach(e=>{e&&je.observe(e)})};return l(()=>{(()=>{if(window.AuthManager){const e=window.AuthManager.getCurrentUser();e?(ke.value=!0,xe.value=e.username):(ke.value=!1,xe.value="")}})(),document.body.classList.add("is-loaded"),qe()}),s(()=>{je&&je.disconnect(),he&&clearTimeout(he)}),t(()=>$e.value.length,()=>{setTimeout(()=>{qe()},100)}),s(()=>{je&&je.disconnect(),he&&clearTimeout(he)}),(e,a)=>{const l=g("router-link");return C(),o("div",G,[i(k),a[17]||(a[17]=r("header",{class:"page-header"},[r("h1",{class:"page-title"},"周边商城"),r("p",{class:"page-subtitle"},"方块之家官方周边，尽在方块街")],-1)),r("div",M,[r("div",_,[r("div",T,[n(r("input",{type:"text",class:"search-input","onUpdate:modelValue":a[0]||(a[0]=e=>pe.value=e),placeholder:"搜索商品...",onInput:Ae},null,544),[[u,pe.value]]),a[9]||(a[9]=r("button",{class:"search-btn"},[r("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[r("path",{d:"M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z",fill:"currentColor"})])],-1)),ge.value&&me.value.length>0?(C(),o("div",B,[(C(!0),o(d,null,v(me.value,e=>(C(),o("div",{key:e.id,class:"suggestion-item",onClick:a=>(e=>{pe.value=e.title,ge.value=!1})(e)},[r("span",V,b(e.title),1),r("span",$,b(e.category),1)],8,P))),128))])):c("",!0)])]),r("div",A,[i(l,{to:Pe.value,class:"user-btn",onClick:Be},{default:p(()=>[...a[10]||(a[10]=[r("span",{class:"user-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[r("path",{d:"M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z",fill:"currentColor"})])],-1),r("span",null,"我的",-1)])]),_:1},8,["to"])])]),r("div",I,[(C(!0),o(d,null,v(Me.value,e=>(C(),o("div",{key:e.value,class:w(["category-item",{active:_e.value===e.value}]),onClick:a=>(e=>{_e.value=e})(e.value)},b(e.label),11,U))),128))]),r("div",Z,[r("div",j,[(C(!0),o(d,null,v($e.value,(e,a)=>(C(),o("div",{key:e.id,class:"product-card","data-id":e.id,ref_for:!0,ref_key:"productCards",ref:Ze,onClick:a=>(e=>{Ie.value=e,document.body.style.overflow="hidden"})(e)},[r("div",H,[r("picture",null,[r("source",{srcset:de(e.image),type:"image/webp"},null,8,N),r("img",{src:y(L)(e.image),alt:e.title,loading:"lazy",decoding:"async",fetchpriority:"low",sizes:"(max-width: 768px) 50vw, (max-width: 1200px) 33vw, 25vw"},null,8,z)])]),r("div",O,[r("span",D,b(e.category),1),r("h3",E,b(e.title),1),r("p",F,b(e.description),1),r("div",J,b(e.price),1),r("button",{class:"product-btn",onClick:a=>Ve(e)}," 获取周边 ",8,R)])],8,q))),128)),0===$e.value.length?(C(),o("div",S,[...a[11]||(a[11]=[r("p",null,"暂无匹配的商品",-1)])])):c("",!0)])]),i(x),be.value?(C(),o("div",{key:0,class:"boh-login-modal-overlay",onClick:a[6]||(a[6]=e=>be.value=!1)},[r("div",{class:"boh-login-modal-container",onClick:a[5]||(a[5]=m(()=>{},["stop"]))},[r("button",{class:"boh-login-modal-close",onClick:a[1]||(a[1]=e=>be.value=!1)}," × "),a[15]||(a[15]=r("div",{class:"boh-login-modal-header"},[r("h2",null,"方块之家"),r("p",null,"这里不只有方块。")],-1)),r("form",{class:"boh-login-form",onSubmit:m(Le,["prevent"])},[r("div",W,[a[12]||(a[12]=r("label",null,"方块ID",-1)),n(r("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=e=>fe.value.username=e),placeholder:"请输入你的用户名",required:""},null,512),[[u,fe.value.username]])]),r("div",Y,[a[13]||(a[13]=r("label",null,"密码",-1)),r("div",K,[n(r("input",{type:we.value?"text":"password","onUpdate:modelValue":a[3]||(a[3]=e=>fe.value.password=e),placeholder:"请输入你的密码",required:""},null,8,Q),[[h,fe.value.password]]),r("button",{type:"button",class:"boh-toggle-password",onClick:a[4]||(a[4]=e=>we.value=!we.value)},b(we.value?"隐藏":"显示"),1)])]),Ce.value?(C(),o("div",X," 用户名或密码错误，请重试 ")):c("",!0),r("div",ee,[r("a",{href:"#",class:"boh-forgot-password",onClick:m(Ge,["prevent"])},"忘记密码？"),a[14]||(a[14]=r("a",{href:"https://docs.qq.com/form/page/DRVZ2TmtwZWRYaU5o",class:"boh-register-link",target:"_blank"},"还没有账号？立即注册",-1))]),r("button",{type:"submit",class:"boh-login-btn",disabled:ye.value},b(ye.value?"登录中...":"登录方块之家"),9,ae)],32)])])):c("",!0),Ie.value?(C(),o("div",{key:1,class:w(["product-modal-overlay",{"is-active":Ie.value}]),onClick:Ue},[r("div",{class:"product-modal-container",onClick:a[8]||(a[8]=m(()=>{},["stop"]))},[r("button",{class:"modal-close-btn",onClick:Ue},"×"),r("div",le,[r("div",se,[r("img",{src:y(L)(Ie.value.image),alt:Ie.value.title,loading:"lazy"},null,8,te)]),r("div",oe,[r("span",ie,b(Ie.value.category),1),r("h2",re,b(Ie.value.title),1),r("div",ce,b(Ie.value.price),1),a[16]||(a[16]=r("div",{class:"modal-divider"},null,-1)),r("p",ne,b(Ie.value.description),1),r("div",ue,[r("button",{class:"modal-primary-btn",onClick:a[7]||(a[7]=e=>Ve(Ie.value))},"获取此周边")])])])])],2)):c("",!0)])}}},[["__scopeId","data-v-2ed98884"]]);export{de as default};
